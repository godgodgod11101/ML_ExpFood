---
title: "Expired Food Data by Logistic"
format: html
jupyter: python3
---


```{python}
import numpy as np 
import pandas as pd
```


## Data Import
```{python}
dict_dfs_ori = pd.read_excel('data\data_ori.xlsx', sheet_name=None)    # get all worksheets
print(dict_dfs_ori.keys())
```

```{python}
# 違規案件稽查編號
set_expSN = set(dict_dfs_ori['ExpCase']['稽查事件編號']) | set(dict_dfs_ori['WebExpCase']['稽查序號'])

# 建立完整資料表，含 target, features, others
df_ori = dict_dfs_ori['Factor'].copy()
df_ori['target'] = df_ori['稽查事件編號'].isin(set_expSN).astype('uint8')    # indexing with isin
```


## Data Preprocess

先將資料縱切3部分：
    目標變數(target)
    特徵(feature)
    其他欄位

```{python}
print(df_ori.columns)
```

```{python}
cols_notFeat = ['稽查事件編號', 'Group', 'target']

ser_target = df_ori[cols_notFeat[-1]]
df_features = df_ori.drop(cols_notFeat, axis=1)    # inplace = False (default), return a copy
df_others = df_ori[cols_notFeat[:-1]]
```


* NA

```{python}
print(df_features.isna().any(axis=0).sum())
```




* Variance Threshold

計算 features' variance 須：
    1. 將 category features 做編碼(用 dummy encoding)
    2. 將 numeric features 做正規化(normalization)
